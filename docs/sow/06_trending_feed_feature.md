# SOW: Zennトレンドフィード機能追加

## 概要

Zenn MCPサーバーに、Zennのトレンド記事を取得する機能を追加する。既存のトピック別フィード機能と並行して、現在話題になっている記事の情報を効率的に取得できるようにする。

## 背景・目的

### 背景
- 現在のMCPサーバーは特定トピックの記事フィード取得のみ対応
- ユーザーが現在のトレンドや話題の記事を把握するニーズがある
- ZennのトレンドフィードURL（https://zenn.dev/feed）が利用可能

### 目的
- 技術動向の効率的な情報収集を支援
- 既存機能との統合により、包括的な情報取得ツールとして価値向上
- Claude Codeユーザーの技術学習・キャッチアップを支援

## 機能要件

### 新規MCPツール仕様
```python
@mcp.tool()
def get_trending_articles(
    max_articles: Annotated[int, "最大取得記事数（1-10）"] = 10
) -> str:
    """Zennから現在のトレンド記事フィードを取得"""
```

### 機能詳細
1. **トレンドフィード取得**
   - URL: `https://zenn.dev/feed`
   - 最大10件までの記事情報を取得
   - RSS XMLフォーマットをパース

2. **取得データ項目**
   - タイトル（`<title>`）
   - 作成者（`<dc:creator>`）
   - 作成日（`<pubDate>`）
   - 概要（`<description>`）
   - URL（`<link>`）

3. **出力フォーマット**
   ```
   # Zennトレンド記事
   取得記事数: X件

   ## 1. [記事タイトル]
   - **作成者**: [作成者名]
   - **作成日**: [投稿日]
   - **概要**: [記事概要]
   - **URL**: [記事URL]
   ```

## 非機能要件

### パフォーマンス
- レスポンス時間: 5秒以内
- タイムアウト: 60秒（既存設定を流用）

### 可用性
- エラー時の適切な処理とログ出力
- ネットワークエラー時のフォールバック

### 拡張性
- 既存アーキテクチャとの整合性維持
- 将来的な機能拡張への対応

## 技術仕様

### アーキテクチャ
既存のZenn MCPサーバーアーキテクチャを拡張

```
app/
├── main.py           # 新MCPツール追加
├── crawler.py        # トレンドフィード取得メソッド追加
├── config.py         # トレンド用URL設定追加
└── logging_config.py # 既存利用
```

### 実装方針
1. **TDD（Test Driven Development）**
   - Kent Beckの原則に従い、テストファーストで実装
   - Red → Green → Refactor サイクルを厳守

2. **既存コードの活用**
   - `ZennCrawler`クラスの拡張
   - `_parse_feed_item`メソッドの再利用
   - エラーハンドリングパターンの統一

3. **設定管理**
   - `Config`クラスに`ZENN_TRENDING_FEED_URL`追加

### データフロー
```
Claude Code要求
↓
FastMCP (main.py)
↓
ZennCrawler.fetch_trending_articles()
↓
requests.get(ZENN_TRENDING_FEED_URL)
↓
BeautifulSoup4パース
↓
構造化データ返却
↓
Markdownフォーマット
↓
Claude Codeに結果表示
```

## 実装計画

### Phase 1: テスト実装（TDD - Red）
1. `test_crawler.py`にトレンドフィード取得テスト追加
   - 正常系テスト
   - エラーハンドリングテスト
   - データ形式検証テスト

### Phase 2: 最小実装（TDD - Green）
1. `config.py`にトレンド用URL追加
2. `crawler.py`に`fetch_trending_articles()`メソッド追加
3. `main.py`に`get_trending_articles` MCPツール追加

### Phase 3: リファクタリング（TDD - Refactor）
1. コード品質向上
2. 既存機能との統合最適化
3. エラーハンドリング強化

### Phase 4: ドキュメント更新
1. `README.md`更新（新MCPツール追記）
2. `docs/requirements.md`更新

## 品質要件

### テストカバレッジ
- 新規機能の100%テストカバレッジ
- 既存テストの継続実行・成功

### コード品質
- vibelogger使用による構造化ログ
- 既存コーディング規約準拠
- 日本語コメント・ドキュメント

## リスク分析

### 技術リスク
| リスク | 影響度 | 発生確率 | 対策 |
|--------|--------|----------|------|
| ZennトレンドフィードAPI変更 | 高 | 低 | エラーハンドリング強化、ログ出力 |
| 既存機能への影響 | 中 | 低 | 独立性の高い設計、テスト網羅 |
| パフォーマンス低下 | 低 | 低 | タイムアウト設定、キャッシュ検討 |

### 運用リスク
| リスク | 影響度 | 発生確率 | 対策 |
|--------|--------|----------|------|
| Zennのレート制限 | 中 | 中 | 適切なリクエスト頻度制御 |
| フィード形式変更 | 中 | 低 | パース処理の堅牢性向上 |

## 成功基準

### 機能要件の達成
- [ ] トレンドフィード取得機能の実装完了
- [ ] 指定件数（1-10件）の記事情報取得可能
- [ ] 作成者、作成日、概要、URLの全項目取得可能

### 品質要件の達成
- [ ] 全テストの成功（既存 + 新規）
- [ ] エラーハンドリングの適切な実装
- [ ] vibeloggerによる構造化ログ出力

### ユーザビリティ
- [ ] Claude Codeからの自然言語での利用可能
- [ ] レスポンス時間5秒以内
- [ ] わかりやすいエラーメッセージ

## 受け入れ基準

### 開発完了条件
1. TDDサイクル完了（Red → Green → Refactor）
2. 全テストの成功
3. MCPサーバーの正常起動・動作確認
4. ドキュメント更新完了

### レビュー項目
1. 既存機能への影響なし
2. コード品質・可読性
3. エラーハンドリングの適切性
4. ログ出力の妥当性
5. テストの網羅性

## スケジュール

### 実装タスク（予定）
- **Day 1**: テスト実装、基本機能実装
- **Day 2**: リファクタリング、ドキュメント更新、テスト

### マイルストーン
1. **M1**: テスト実装完了（TDD Red）
2. **M2**: 基本機能実装完了（TDD Green）
3. **M3**: リファクタリング完了（TDD Refactor）
4. **M4**: ドキュメント更新・受け入れテスト完了

---

**作成日**: 2025-07-15  
**作成者**: Claude Code  
**承認者**: （プロジェクトオーナー）